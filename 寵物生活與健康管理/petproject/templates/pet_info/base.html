<!-- templates/pet_info/base.html -->
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}毛日好(Paw&Day){% endblock %}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f7f7f7;
        }

        /* 導覽列允許換行 */
        .navbar {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }
        .nav-btn {
            background-color: #ffffff;
            border: 1px solid #007bff;
            color: #007bff;
            padding: 8px 16px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: 0.3s;
        }
        .nav-btn:hover {
            background-color: #007bff;
            color: white;
        }
        
        /* 預設讓返回排在最前面 */
        .back-btn {
            order: -1;
        
        }
        /* 可選：預設讓它在最左側 */
        .left-nav {
            display: flex;
        }

        /* 當畫面寬度小於 768px，自動讓 back-btn 跑到下一列 */
        @media (max-width: 768px) {
            .navbar {
                flex-wrap: wrap;
            }
            .left-nav {
                width: 100%;
                margin-bottom: 10px;
            }
            .back-btn {
                order: 10;
                width: auto;
                margin-top: 10px;
            }
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body>
    <!-- 導覽列 -->
    <div class="navbar" style="display: flex; justify-content: space-between; align-items: center;">
        <!-- 左側：返回按鈕 -->
        <div class="left-nav">
            <a href="javascript:history.back()" class="nav-btn back-btn">← 返回</a>
        </div>

        <!-- 右側：功能選單與登入區塊 -->
        <div class="right-nav" style="display: flex; gap: 10px; align-items: center;">
            <a href="{% url 'pet_list' %}" class="nav-btn">🐾 寵物</a>
            <a href="{% url 'health_rec' %}" class="nav-btn">🩺 健康記錄</a>
            <div style="position: relative;">
                <div class="nav-btn" onclick="toggleNotice()" style="cursor: pointer;">
                    <span class="nav-label">🔔 通知</span>
                        {% if notif_count > 0 %}
                            <span id="notif-count" style="
                                position: absolute;
                                top: -5px;
                                right: -10px;
                                background-color: red;
                                color: white;
                                font-size: 12px;
                                font-weight: bold;
                                border-radius: 50%;
                                padding: 2px 6px;
                                line-height: 1;
                                display: inline-block;
                            ">
                                {{ notif_count }}
                            </span>
                        {% endif %}
                </div>

                <div id="notification-box" class="notification-box unread" style="display: none; position: absolute; top: 100%; right: 0; border: 1px solid #ccc; padding: 10px; z-index: 99; min-width: 280px; background-color: #ffffff;">
                    {% if tomorrow_appointments %}

                    <div>明日預約提醒</div>

                        <ul style="list-style: disc; padding-left: 20px; margin: 5px 0;">
                            {% for appt in tomorrow_appointments %}
                            <li style="cursor: pointer;">
                                <span onclick="markAsRead()">
                                    {{ appt.pet.name }}｜{{ appt.time }}<br>
                                    {{ appt.vet.clinic_name }}（{{ appt.vet.user.last_name }}{{ appt.vet.user.first_name }}）
                                </span>
                            </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <em style="color: #888;">無即將到來的預約</em>
                    {% endif %}
                </div>
            </div>

            {% if user.is_authenticated %}
                <a href="{% url 'account_logout' %}" class="nav-btn">登出</a>
            {% else %}                    
                <a href="{% url 'account_login' %}" class="nav-btn">登入</a>
                <a href="{% url 'account_signup' %}" class="nav-btn">註冊</a>
            {% endif %}
        
        </div>

    </div>

    {% block content %}
    {% endblock %}

    {% block extra_script %}{% endblock %}
</body>
</html>